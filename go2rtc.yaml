# go2rtc Configuration - VendVision Demo Center
#
# Combined configuration with:
#   - Hardware acceleration (Apple VideoToolbox) when available
#   - High quality settings (CRF-equivalent quality via q:v)
#   - Automatic software fallback if hardware unavailable (-allow_sw 1)
#
# This config works on:
#   ✅ Mac (Apple Silicon) - Uses VideoToolbox hardware encoder
#   ✅ Mac (Intel) - Uses VideoToolbox or falls back to software
#   ✅ Linux/Windows - Falls back to software encoding
#
# Expected latency: ~30-50ms (hardware) / ~150ms (software fallback)
#

streams:
  site1_main:
    - rtsp://secretlab:tapo123@10.1.10.193:554/stream1
  site1_dewarped:
    - ffmpeg:site1_main#video=h264#raw=-fflags nobuffer+genpts -flags low_delay -probesize 32 -analyzeduration 0 -vf scale=1920:1080 -c:v h264_videotoolbox -realtime true -q:v 65 -allow_sw 1
  site2_main:
    - rtsp://secretlab:tapo123@10.1.10.149:554/stream1
  site2_dewarped:
    - ffmpeg:site2_main#video=h264#raw=-fflags nobuffer+genpts -flags low_delay -probesize 32 -analyzeduration 0 -vf scale=1920:1080 -c:v h264_videotoolbox -realtime true -q:v 65 -allow_sw 1
  
  # Raw passthrough streams (original camera quality, no re-encoding)
  site1_raw:
    - rtsp://secretlab:tapo123@10.1.10.193:554/stream1#video=copy
  site2_raw:
    - rtsp://secretlab:tapo123@10.1.10.149:554/stream1#video=copy

webrtc:
  listen: ':8555'
  ice_servers:
    - urls:
        - stun:stun.l.google.com:19302
api:
  listen: ':1984'
log:
  level: info
